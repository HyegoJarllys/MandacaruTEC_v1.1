<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arquitetura Agente IA - Mandacaru PDV</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(to bottom right, #0f172a, #1e3a8a, #0f172a);
            color: #fff;
            min-height: 100vh;
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 24px;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 32px;
        }

        .header h1 {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 8px;
            background: linear-gradient(to right, #60a5fa, #4ade80);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            color: #cbd5e1;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            background: #1e293b;
            padding: 8px;
            border-radius: 8px;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
        }

        .tab-btn {
            padding: 12px 24px;
            border: none;
            background: transparent;
            color: #fff;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.3s;
            font-size: 14px;
            font-weight: 500;
        }

        .tab-btn:hover {
            background: #334155;
        }

        .tab-btn.active {
            background: #2563eb;
        }

        /* Content */
        .content {
            display: none;
        }

        .content.active {
            display: block;
        }

        /* Cards Grid */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 16px;
            margin-bottom: 32px;
        }

        .card {
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 8px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .card:hover {
            background: #0f172a;
            border-color: #3b82f6;
            transform: translateY(-4px);
        }

        .card-icon {
            width: 56px;
            height: 56px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 16px;
            font-size: 28px;
        }

        .card-icon.yellow {
            background: #eab308;
            color: #000;
        }

        .card-icon.green {
            background: #22c55e;
            color: #fff;
        }

        .card-icon.blue {
            background: #3b82f6;
            color: #fff;
        }

        .card-icon.orange {
            background: #f97316;
            color: #fff;
        }

        .card-icon.purple {
            background: #a855f7;
            color: #fff;
        }

        .card h3 {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .card-trigger {
            font-size: 14px;
            color: #94a3b8;
            margin-bottom: 12px;
        }

        .card-desc {
            color: #cbd5e1;
            font-size: 14px;
            margin-bottom: 16px;
        }

        .card-link {
            color: #60a5fa;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        /* Detail View */
        .detail {
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 8px;
            padding: 32px;
        }

        .back-btn {
            background: none;
            border: none;
            color: #94a3b8;
            cursor: pointer;
            margin-bottom: 24px;
            font-size: 14px;
            transition: color 0.3s;
        }

        .back-btn:hover {
            color: #fff;
        }

        .detail-header {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
            align-items: flex-start;
        }

        .detail-icon {
            width: 64px;
            height: 64px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            flex-shrink: 0;
        }

        .detail-title h2 {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .detail-title p {
            color: #94a3b8;
        }

        /* Sections */
        .section {
            margin-bottom: 24px;
        }

        .section h3 {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 16px;
            color: #60a5fa;
        }

        .trigger-box {
            background: #1f2937;
            border: 1px solid #10b981;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 24px;
        }

        .trigger-box-title {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #10b981;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .trigger-box-content {
            color: #e2e8f0;
        }

        /* Nodes */
        .nodes {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .node {
            display: flex;
            gap: 16px;
            align-items: flex-start;
        }

        .node-number {
            background: #2563eb;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .node-content {
            background: #0f172a;
            flex: 1;
            padding: 16px;
            border-radius: 8px;
            border: 1px solid #334155;
        }

        .node-type {
            color: #60a5fa;
            font-weight: bold;
        }

        .node-config {
            color: #cbd5e1;
            font-size: 14px;
            margin-top: 4px;
        }

        /* Commands Grid */
        .commands-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 12px;
        }

        .command-item {
            background: #0f172a;
            border: 1px solid #334155;
            border-radius: 8px;
            padding: 16px;
        }

        .command-code {
            color: #4ade80;
            font-family: monospace;
            font-weight: bold;
        }

        .command-desc {
            color: #cbd5e1;
            font-size: 14px;
            margin-top: 8px;
        }

        /* Code Block */
        .code-block {
            background: #0f172a;
            border: 1px solid #334155;
            border-radius: 8px;
            padding: 16px;
            overflow-x: auto;
            font-family: monospace;
            font-size: 13px;
            color: #cbd5e1;
            margin-bottom: 24px;
        }

        /* Output Box */
        .output-box {
            background: #0f172a;
            border: 1px solid #334155;
            border-radius: 8px;
            padding: 24px;
            font-family: monospace;
            font-size: 14px;
            color: #cbd5e1;
            white-space: pre-wrap;
            word-break: break-word;
        }

        /* Database Tab */
        .db-section {
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 8px;
            padding: 32px;
            margin-bottom: 24px;
        }

        .db-section h2 {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 24px;
            color: #60a5fa;
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .table-section {
            margin-bottom: 32px;
        }

        .table-title {
            font-size: 18px;
            font-weight: bold;
            color: #4ade80;
            margin-bottom: 12px;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            background: #0f172a;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid #334155;
        }

        .table th {
            background: #1a202c;
            padding: 12px;
            text-align: left;
            color: #60a5fa;
            font-weight: bold;
            border-bottom: 1px solid #334155;
        }

        .table td {
            padding: 12px;
            border-bottom: 1px solid #334155;
            color: #cbd5e1;
        }

        .table tr:last-child td {
            border-bottom: none;
        }

        .status-new {
            background: #92400e;
            color: #fde047;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
        }

        .status-exists {
            background: #166534;
            color: #86efac;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
        }

        .alert-box {
            background: linear-gradient(to right, #78350f, #1e3a8a);
            border: 1px solid #2563eb;
            border-radius: 8px;
            padding: 24px;
            margin-top: 24px;
        }

        .alert-title {
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 12px;
            display: flex;
            gap: 8px;
            align-items: center;
            color: #fca5a5;
        }

        .alert-box p {
            color: #e2e8f0;
            margin-bottom: 12px;
        }

        .alert-steps {
            background: #0f172a;
            padding: 12px;
            border-radius: 6px;
            font-size: 14px;
        }

        .alert-steps ol {
            margin-left: 20px;
        }

        .alert-steps li {
            color: #cbd5e1;
            margin-bottom: 4px;
        }

        /* Setup Tab */
        .setup-section {
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 16px;
        }

        .setup-title {
            font-size: 18px;
            font-weight: bold;
            color: #60a5fa;
            margin-bottom: 16px;
        }

        .setup-steps {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .setup-step {
            display: flex;
            gap: 12px;
            align-items: flex-start;
        }

        .setup-number {
            background: #2563eb;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .setup-content {
            background: #0f172a;
            flex: 1;
            padding: 12px;
            border-radius: 6px;
            border: 1px solid #334155;
            font-family: monospace;
            font-size: 13px;
            color: #cbd5e1;
        }

        /* Checklist */
        .checklist-box {
            background: linear-gradient(to right, #064e3b, #1e3a8a);
            border: 1px solid #10b981;
            border-radius: 8px;
            padding: 24px;
        }

        .checklist-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 12px;
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .checklist-items {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .checklist-item {
            display: flex;
            align-items: center;
            gap: 12px;
            color: #cbd5e1;
        }

        .checklist-item input {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 24px;
            }

            .tabs {
                flex-direction: column;
            }

            .detail-header {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>Arquitetura do Agente IA</h1>
            <p>PDV Mandacaru + n8n + Evolution API + PostgreSQL</p>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('architecture')">Workflows</button>
            <button class="tab-btn" onclick="switchTab('database')">Banco de Dados</button>
            <button class="tab-btn" onclick="switchTab('setup')">Configura√ß√£o</button>
        </div>

        <!-- Architecture Tab -->
        <div id="architecture" class="content active">
            <div id="workflow-list" style="display: block;">
                <div class="grid" id="workflows-grid"></div>
            </div>
            <div id="workflow-detail" style="display: none;">
                <div id="detail-content"></div>
            </div>
        </div>

        <!-- Database Tab -->
        <div id="database" class="content">
            <div class="db-section">
                <h2>üìä Estrutura do Banco PostgreSQL</h2>
                <div id="db-tables"></div>
                <div class="alert-box" id="migration-alert"></div>
            </div>
        </div>

        <!-- Setup Tab -->
        <div id="setup" class="content">
            <div id="setup-steps"></div>
            <div class="checklist-box">
                <h3 class="checklist-title">‚úì Checklist Final</h3>
                <div class="checklist-items">
                    <label class="checklist-item">
                        <input type="checkbox">
                        <span>PostgreSQL configurado no n8n</span>
                    </label>
                    <label class="checklist-item">
                        <input type="checkbox">
                        <span>Evolution API conectada</span>
                    </label>
                    <label class="checklist-item">
                        <input type="checkbox">
                        <span>Campos novos adicionados ao banco</span>
                    </label>
                    <label class="checklist-item">
                        <input type="checkbox">
                        <span>PDV chamando webhook ap√≥s venda</span>
                    </label>
                    <label class="checklist-item">
                        <input type="checkbox">
                        <span>Workflows importados no n8n</span>
                    </label>
                    <label class="checklist-item">
                        <input type="checkbox">
                        <span>Teste de envio WhatsApp OK</span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <script>
        const workflows = [
            {
                id: 'webhook-vendas',
                name: 'Webhook de Vendas',
                icon: '‚ö°',
                color: 'yellow',
                trigger: 'A cada venda no PDV',
                description: 'Recebe dados da venda em tempo real e processa alertas cr√≠ticos',
                nodes: [
                    { type: 'Webhook', config: 'POST /venda-realizada' },
                    { type: 'PostgreSQL', config: 'Atualiza estoque' },
                    { type: 'Code', config: 'Verifica se estoque < m√≠nimo' },
                    { type: 'IF', config: 'Estoque cr√≠tico?' },
                    { type: 'Evolution API', config: 'Envia alerta WhatsApp' },
                ],
                code: `// No seu PDV (ap√≥s finalizar venda)
async function enviarVendaParaN8n(resumo) {
  await fetch('http://localhost:5678/webhook/venda-realizada', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      venda_id: resumo.id,
      itens: resumo.itens,
      total: resumo.total,
      data_hora: resumo.data_hora
    })
  });
}`
            },
            {
                id: 'bot-whatsapp',
                name: 'Bot de Consultas WhatsApp',
                icon: 'üí¨',
                color: 'green',
                trigger: 'Mensagem recebida no WhatsApp',
                description: 'Responde perguntas do dono sobre estoque, vendas e relat√≥rios',
                nodes: [
                    { type: 'Evolution Webhook', config: 'Recebe mensagem' },
                    { type: 'Code', config: 'Detecta inten√ß√£o (NLP simples)' },
                    { type: 'Switch', config: 'Rota por tipo de consulta' },
                    { type: 'PostgreSQL', config: 'Busca dados' },
                    { type: 'Code', config: 'Formata resposta' },
                    { type: 'Evolution API', config: 'Envia resposta' },
                ],
                commands: [
                    { cmd: 'estoque [produto]', desc: 'Consulta quantidade em estoque' },
                    { cmd: 'vendas hoje', desc: 'Relat√≥rio do dia' },
                    { cmd: 'top 5', desc: 'Produtos mais vendidos' },
                    { cmd: 'parados', desc: 'Produtos sem venda h√° 7+ dias' },
                    { cmd: 'previs√£o [produto]', desc: 'Quando vai acabar' },
                ]
            },
            {
                id: 'alerta-diario',
                name: 'Relat√≥rio Di√°rio Autom√°tico',
                icon: '‚è∞',
                color: 'blue',
                trigger: 'Cron: Todo dia √†s 20h',
                description: 'Envia resumo do dia automaticamente',
                nodes: [
                    { type: 'Schedule', config: 'Cron: 0 20 * * *' },
                    { type: 'PostgreSQL', config: 'SELECT vendas do dia' },
                    { type: 'Code', config: 'Calcula m√©tricas' },
                    { type: 'Evolution API', config: 'Envia relat√≥rio' },
                ],
                output: `üìä *Resumo do Dia - 14/11/2025*

üí∞ Faturamento: R$ 1.847,50
üõí Vendas: 23
üìà Ticket m√©dio: R$ 80,33

üî• *Top 3 Produtos:*
1. Arroz 5kg - 12 unidades
2. Feij√£o 1kg - 8 unidades  
3. √ìleo de Soja - 7 unidades

‚ö†Ô∏è *Alertas:*
‚Ä¢ Caf√© Pil√£o: apenas 3 pacotes
‚Ä¢ A√ß√∫car Cristal: 5 kg restantes`
            },
            {
                id: 'alerta-estoque',
                name: 'Verifica√ß√£o de Estoque',
                icon: 'üì¶',
                color: 'orange',
                trigger: 'Cron: A cada 2 horas',
                description: 'Verifica produtos com estoque baixo e envia alertas',
                nodes: [
                    { type: 'Schedule', config: 'Cron: 0 */2 * * *' },
                    { type: 'PostgreSQL', config: 'SELECT produtos WHERE qtd < minimo' },
                    { type: 'IF', config: 'H√° produtos cr√≠ticos?' },
                    { type: 'Code', config: 'Gera lista + sugest√£o de compra' },
                    { type: 'Evolution API', config: 'Envia alerta' },
                ]
            },
            {
                id: 'analise-semanal',
                name: 'An√°lise Semanal Inteligente',
                icon: 'üìà',
                color: 'purple',
                trigger: 'Cron: Domingo √†s 18h',
                description: 'An√°lise profunda com insights e recomenda√ß√µes',
                nodes: [
                    { type: 'Schedule', config: 'Cron: 0 18 * * 0' },
                    { type: 'PostgreSQL', config: 'Dados √∫ltimas 4 semanas' },
                    { type: 'Code', config: 'An√°lise de tend√™ncias' },
                    { type: 'HTTP', config: 'API Claude (opcional)' },
                    { type: 'Evolution API', config: 'Envia relat√≥rio' },
                ]
            }
        ];

        const dbSchema = {
            produtos: [
                { campo: 'id', tipo: 'SERIAL PRIMARY KEY', novo: false },
                { campo: 'codigo_barras', tipo: 'TEXT UNIQUE', novo: false },
                { campo: 'nome', tipo: 'TEXT', novo: false },
                { campo: 'preco', tipo: 'DECIMAL(10,2)', novo: false },
                { campo: 'quantidade_estoque', tipo: 'INTEGER', novo: true },
                { campo: 'estoque_minimo', tipo: 'INTEGER', novo: true },
                { campo: 'ultima_venda', tipo: 'TIMESTAMP', novo: true },
                { campo: 'validade', tipo: 'DATE', novo: true },
            ],
            vendas: [
                { campo: 'id', tipo: 'SERIAL PRIMARY KEY', novo: false },
                { campo: 'data_hora', tipo: 'TIMESTAMP', novo: false },
                { campo: 'total', tipo: 'DECIMAL(10,2)', novo: false },
                { campo: 'forma_pagamento', tipo: 'TEXT', novo: false },
            ],
            itens_venda: [
                { campo: 'id', tipo: 'SERIAL PRIMARY KEY', novo: false },
                { campo: 'venda_id', tipo: 'INTEGER REFERENCES vendas(id)', novo: false },
                { campo: 'codigo_barras', tipo: 'TEXT', novo: false },
                { campo: 'quantidade', tipo: 'INTEGER', novo: false },
                { campo: 'subtotal', tipo: 'DECIMAL(10,2)', novo: false },
            ]
        };

        const setupSteps = [
            {
                title: '1. Configurar PostgreSQL no n8n',
                steps: [
                    'No n8n: Settings ‚Üí Credentials ‚Üí Add Credential ‚Üí PostgreSQL',
                    'Host: localhost (ou IP do container)',
                    'Database: mandacarutec',
                    'User: seu_usuario',
                    'Password: sua_senha',
                    'Port: 5432',
                    'Testar conex√£o'
                ]
            },
            {
                title: '2. Configurar Evolution API',
                steps: [
                    'J√° deve estar rodando no Docker',
                    'No n8n: Add Credential ‚Üí HTTP Header Auth',
                    'Nome: Evolution-API',
                    'Header Name: apikey',
                    'Header Value: sua_api_key_evolution',
                    'Endpoint base: http://evolution-api:8080'
                ]
            },
            {
                title: '3. Adicionar campos ao banco',
                steps: [
                    'Execute este SQL no PostgreSQL:',
                    'ALTER TABLE produtos ADD COLUMN quantidade_estoque INTEGER DEFAULT 0;',
                    'ALTER TABLE produtos ADD COLUMN estoque_minimo INTEGER DEFAULT 10;',
                    'ALTER TABLE produtos ADD COLUMN ultima_venda TIMESTAMP;',
                    'ALTER TABLE produtos ADD COLUMN validade DATE;'
                ]
            },
            {
                title: '4. Modificar PDV para chamar webhook',
                steps: [
                    'Em pdv_functions.py, adicione ap√≥s salvar_venda_no_banco():',
                    'import requests',
                    'requests.post("http://localhost:5678/webhook/venda-realizada", json=resumo)',
                    'Tamb√©m atualize quantidade_estoque ap√≥s cada venda'
                ]
            }
        ];

        function switchTab(tabName) {
            // Hide all content
            document.querySelectorAll('.content').forEach(el => el.classList.remove('active'));
            // Remove active from buttons
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            // Mark button as active
            event.target.classList.add('active');

            // Populate content if needed
            if (tabName === 'architecture' && !document.getElementById('workflows-grid').innerHTML) {
                renderWorkflows();
            }
            if (tabName === 'database' && !document.getElementById('db-tables').innerHTML) {
                renderDatabase();
            }
            if (tabName === 'setup' && !document.getElementById('setup-steps').innerHTML) {
                renderSetup();
            }
        }

        function renderWorkflows() {
            const grid = document.getElementById('workflows-grid');
            grid.innerHTML = workflows.map(wf => `
                <div class="card" onclick="showWorkflowDetail('${wf.id}')">
                    <div class="card-icon ${wf.color}">${wf.icon}</div>
                    <h3>${wf.name}</h3>
                    <div class="card-trigger">‚è∞ ${wf.trigger}</div>
                    <p class="card-desc">${wf.description}</p>
                    <div class="card-link">Ver detalhes ‚Üí</div>
                </div>
            `).join('');
        }

        function showWorkflowDetail(workflowId) {
            const workflow = workflows.find(w => w.id === workflowId);
            const list = document.getElementById('workflow-list');
            const detail = document.getElementById('workflow-detail');
            const detailContent = document.getElementById('detail-content');

            let html = `
                <button class="back-btn" onclick="hideWorkflowDetail()">‚Üê Voltar</button>
                <div class="detail-header">
                    <div class="detail-icon ${workflow.color}">${workflow.icon}</div>
                    <div class="detail-title">
                        <h2>${workflow.name}</h2>
                        <p>${workflow.description}</p>
                    </div>
                </div>

                <div class="trigger-box">
                    <div class="trigger-box-title">‚ö° Trigger</div>
                    <div class="trigger-box-content">${workflow.trigger}</div>
                </div>

                <div class="section">
                    <h3>Fluxo de N√≥s (Nodes)</h3>
                    <div class="nodes">
                        ${workflow.nodes.map((node, idx) => `
                            <div class="node">
                                <div class="node-number">${idx + 1}</div>
                                <div class="node-content">
                                    <div class="node-type">${node.type}</div>
                                    <div class="node-config">${node.config}</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            if (workflow.commands) {
                html += `
                    <div class="section">
                        <h3>üí¨ Comandos Dispon√≠veis</h3>
                        <div class="commands-grid">
                            ${workflow.commands.map(cmd => `
                                <div class="command-item">
                                    <div class="command-code">${cmd.cmd}</div>
                                    <div class="command-desc">${cmd.desc}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            if (workflow.code) {
                html += `
                    <div class="section">
                        <h3>üîß C√≥digo de Integra√ß√£o (PDV)</h3>
                        <div class="code-block">${workflow.code}</div>
                    </div>
                `;
            }

            if (workflow.output) {
                html += `
                    <div class="section">
                        <h3>üì§ Exemplo de Sa√≠da</h3>
                        <div class="output-box">${workflow.output}</div>
                    </div>
                `;
            }

            detailContent.innerHTML = html;
            list.style.display = 'none';
            detail.style.display = 'block';
        }

        function hideWorkflowDetail() {
            document.getElementById('workflow-list').style.display = 'block';
            document.getElementById('workflow-detail').style.display = 'none';
        }

        function renderDatabase() {
            const dbTables = document.getElementById('db-tables');
            const migrationAlert = document.getElementById('migration-alert');

            dbTables.innerHTML = Object.entries(dbSchema).map(([tableName, fields]) => `
                <div class="table-section">
                    <div class="table-title">Tabela: ${tableName}</div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Campo</th>
                                <th>Tipo</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${fields.map(field => `
                                <tr>
                                    <td style="font-family: monospace;">${field.campo}</td>
                                    <td>${field.tipo}</td>
                                    <td>
                                        ${field.novo ? 
                                            '<span class="status-new">ADICIONAR</span>' : 
                                            '<span class="status-exists">EXISTENTE</span>'
                                        }
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `).join('');

            migrationAlert.innerHTML = `
                <div class="alert-title">‚ö†Ô∏è Importante: Migra√ß√£o do SQLite para PostgreSQL</div>
                <p>Seu sistema atual usa SQLite. Para usar o agente, voc√™ precisa migrar para PostgreSQL.</p>
                <div class="alert-steps">
                    <p style="margin-bottom: 8px; font-weight: bold;">Passos:</p>
                    <ol>
                        <li>Instalar PostgreSQL no Docker</li>
                        <li>Criar banco "mandacarutec"</li>
                        <li>Rodar create_db.py adaptado para PostgreSQL</li>
                        <li>Exportar dados do SQLite e importar</li>
                        <li>Atualizar db.py para usar psycopg2</li>
                    </ol>
                </div>
            `;
        }

        function renderSetup() {
            const setupDiv = document.getElementById('setup-steps');
            setupDiv.innerHTML = setupSteps.map((section, idx) => `
                <div class="setup-section">
                    <div class="setup-title">${section.title}</div>
                    <div class="setup-steps">
                        ${section.steps.map((step, stepIdx) => `
                            <div class="setup-step">
                                <div class="setup-number">${stepIdx + 1}</div>
                                <div class="setup-content">${step}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        // Initial render
        renderWorkflows();
    </script>
</body>
</html>
